# Aesthetic or death
colorscheme catppuccin_mocha

## Options
#
# Tabs
set-option global tabstop 2
set-option global indentwidth 2

# keep one line and three columns displayed around the cursor
set-option global scrolloff 1,3

# change assistant
set-option global ui_options terminal_assistant=cat terminal_status_on_top=true

## Highlighters
#
# line numbers
add-highlighter global/ number-lines -hlcursor

# highlight matching symbols
add-highlighter global/ show-matching

# soft-wrap lines
add-highlighter global/ wrap -word -indent

## Mappings
#
# general remapping
map global normal '#' :comment-line<ret> -docstring 'comment line'
map global normal '<a-#>' :comment-block<ret> -docstring 'comment block'
map global normal '<a-x>' ':w<ret>'
map global insert '<a-x>' '<a-;>:w<ret>'
map global insert '<c-w>' '<esc>bc' -docstring 'convenience shortcut to change previous word in insert mode'

# user mode
map global user s '<esc>:w<ret>'
map global user q '<esc>:q!<ret>'
map global user z '<esc>:wq<ret>'

## Hooks
#
# tabs for autocomplete
hook global InsertCompletionShow .* %{
  try %{
    # this command temporarily removes cursors preceded by whitespace;
    # if there are no cursors left, it raises an error, does not
    # continue to execute the mapping commands, and the error is eaten
    # by the `try` command so no warning appears.
    execute-keys -draft 'h<a-K>\h<ret>'
    map window insert <tab> <c-n>
    map window insert <s-tab> <c-p>
    hook -once -always window InsertCompletionHide .* %{
      unmap window insert <tab> <c-n>
      unmap window insert <s-tab> <c-p>
    }
  }
}
