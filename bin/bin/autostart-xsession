#!/bin/bash

##################################
##################################
####                          ####
###   XOrg AutoStart Script    ###
####                          ####
##################################
##################################

 
# Tools of note:
#
# NAME        DESCRIPTION                                  WM/DE
# -----------|--------------------------------------------|------|
# picom       compositor (see ~/.config/picom/picom.conf)  all
# xss-lock    to enable screensaver                        all
# xsecurelock the actual screensaver                       all
# Dunst       notifications (see ~/.config/dunst/dunstrc)  bspwm
# feh         background and image viewer                  bspwm
# polybar     bar (see ~/.config/polybar/config.ini)       bspwm
# SXHKD       hotkey daemon (see ~/.config/sxhkd/sxhkdrc)  bspwm


# If iterating a wm config, don't restart programs
[ "$SESSION_AUTOSTARTED" == "true" ] && exit 0

# Common programs

# screensaver and locker of choice
xset s 300 5 &
xss-lock -l -- lockscreen &

#### SOUP ####
pgrep -x picom > /dev/null || picom &

# night color adjustment
pgrep -x redshift > /dev/null || redshift &


# bspwm-only
if [ "$GDMSESSION" == "bspwm" ]
then
  # Start hotkey daemon (sxhkd)
  export SXHKD_SHELL="sh" # important for speed
  pgrep -x sxhkd > /dev/null || sxhkd &

  # notifications
  pgrep -x dunst > /dev/null || dunst &

  # launch bar
  ~/.config/polybar/launch.sh

  # background! this will be fancy someday
  feh --bg-scale ~/.local/share/wallpapers/current/Deep_Space_75_Withou_A_Logo.jpg
fi

export SESSION_AUTOSTARTED="true"
notify-send "Autostart Complete" "session is up and running!"
